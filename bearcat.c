#include <fcntl.h>
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>

#define BEARCAT "\
           8888                                            88888             \n\
          888888888                                    8888888888            \n\
          888....888888                             888888.....88            \n\
          888.88....88888                         888888.......888           \n\
          888.8888....88888888888888888888888888888888.....88..888           \n\
         888..88888.....88888.......88.........88888.....8888...88           \n\
         888..888888......888.................8888......88888...88           \n\
         888..88888..8.....8888..............8888........888...888           \n\
         888..888888......888888............8888888.....8.88...888           \n\
          888..8888..88..................................888..8888           \n\
           888..88888....................8.............8888...88             \n\
     8     888...888..8................88................88...88             \n\
     888   888...88.88.................88.................8888888            \n\
     8888888888.888888................888...............8.88888888888888     \n\
     88..888.888888888................888...............8888888.88888888     \n\
    8888......88888888................888...............888888.......888     \n\
    88888......8888888................8888...........8.8888888.......888     \n\
    88888......8888888.888............88...........88888888888......88888    \n\
    88...8.....8888888888888888.................88888888888888....888..88    \n\
    88....8....8888.88888888888888..........888888888888888888.........88    \n\
    888.....8...88...88888888888888........88888888888888.8888.........88    \n\
    888..........8...88888.8888.8888......888888888.8888...88..........88    \n\
     888............88............88......888..........88..8..........888    \n\
     888.................8888.88..88......88..8...888.................88     \n\
     8888..............88888888888..8....8..88888888888..............888     \n\
      8888.............8888...88888........8.888...8888..............888     \n\
       8888...........888888...888...........88...88888............8888      \n\
        8888...........8888.....88..........88....88888............888       \n\
         8888..........888888...88888....88888..8888888...........888        \n\
          88888...88.....88888.888888888888888..88888......88..88888         \n\
           8888888..8888888........888..8888.........88888...88888           \n\
             8888.........8888......888888......88888.......8888             \n\
            888.......88888.8888....88888888..8888..88........88             \n\
            88....8888888888.888888888...88888888.888.8888888..88            \n\
            88888888888888888.88...8.888888..88.888888888888888888           \n\
            8888         8888..88.888.88.888.88.888            888           \n\
            88             88..8888...8...8888.888                           \n\
                            88.888888888.88888.88                            \n\
                            88..8..8888888.88.888                            \n\
                            888.8888......88..88                             \n\
                             888..88888888...888                             \n\
                              888...........888                              \n\
                                8888888888888                                \n\
                                   8888888                                   \n\
"

int main(int argc, char *argv[]) {
	if(argc < 2) {
		printf("usage: ./bearcat files\n");
		exit(1);
	}
	char d;
	int fd;
	int i = 0;
	int nread = 0;
	int fread = 1;
	if((fd = open(argv[fread++], O_RDONLY)) == -1) {
		printf("Could not open file\n");
		exit(1);
	}
	while(BEARCAT[i] != 0) {
		char c = BEARCAT[i++];
		if(c == '8') {
			while((nread = read(fd, &d, 1)) > 0) {
				if(!(d == ' ' || d == '\t' || d == '\r' ||
				d == '\n' || d == '\x0b')) {
					printf("%c", d);
					break;
				}
			}
			if(nread == 0) {
				if(fread == argc) {
					printf("8");
				}
				else {
					close(fd);
					if((fd = open(argv[fread++], O_RDONLY)) == -1) {
						printf("\nCould not open file\n");
						exit(1);
					}
					i--;
				}
			}
		}
		else {
			printf("%c", c);
		}
		if(BEARCAT[i] == 0 && nread > 0) {
			i = 0;
		}
	}
	close(fd);
	exit(0);
}
